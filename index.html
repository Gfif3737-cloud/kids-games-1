<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>–ò–≥—Ä—ã –≤ –º–µ—Ç—Ä–æ</title>
<style>
body{
  margin:0;
  background:#b0161a;
  color:white;
  font-family:Arial, sans-serif;
  text-align:center;
}
h1{font-size:34px;margin:20px 0;}
h2{margin:10px 0;}
p{margin:10px 0;}

.screen{display:none;padding:20px;}
.active{display:block;}

.btn{
  background:white;
  color:#b0161a;
  border:none;
  border-radius:30px;
  padding:14px 26px;
  font-size:18px;
  margin:10px;
  cursor:pointer;
}

.line-red{background:#e53935;color:white;}
.line-blue{background:#1e88e5;color:white;}
.line-purple{background:#8e24aa;color:white;}
.gray{background:#555;color:white;}

.char-grid{
  display:grid;
  grid-template-columns:repeat(2,140px);
  gap:12px;
  justify-content:center;
  margin-top:15px;
}
.char-btn{
  background:#222;
  border-radius:18px;
  padding:14px;
  font-size:16px;
  cursor:pointer;
}
.char-btn:hover{background:#333;}

.memory-grid{
  display:grid;
  gap:10px;
  justify-content:center;
  margin-top:15px;
}
.card{
  width:60px;
  height:60px;
  background:#222;
  border-radius:12px;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:28px;
  cursor:pointer;
}
.card.open{background:white;color:black;}
.card.done{background:#4caf50;color:white;}

.maze{
  display:grid;
  gap:6px;
  justify-content:center;
  margin-top:15px;
}
.cell{
  width:40px;
  height:40px;
  border-radius:8px;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:22px;
}
.wall{background:#111;}
.path{background:white;color:black;}
.player{background:#4caf50;}
.goal{background:#ffeb3b;color:black;}

.controls{
  margin-top:15px;
}
.ctrl-btn{
  font-size:22px;
  padding:10px 18px;
  margin:6px;
  border-radius:12px;
  border:none;
  cursor:pointer;
}

/* ===== MATCH 3 ===== */
.match-grid{
  display:grid;
  gap:8px;
  justify-content:center;
  margin-top:15px;
}
.tile{
  width:50px;
  height:50px;
  border-radius:12px;
  font-size:26px;
  display:flex;
  align-items:center;
  justify-content:center;
  cursor:pointer;
}
.selected{outline:4px solid yellow;}
.station-list{margin-top:15px;font-size:16px;}
</style>
</head>
<body>

<!-- ===== MENU ===== -->
<div id="menu" class="screen active">
  <h1>–ò–ì–†–´ –í –ú–ï–¢–†–û</h1>
  <p>–í—ã–±–µ—Ä–∏ –ª–∏–Ω–∏—é</p>
  <button class="btn line-red" onclick="openMemory()">üî¥ –õ–∏–Ω–∏—è –ø–∞–º—è—Ç–∏</button>
  <button class="btn line-blue" onclick="openMaze()">üîµ –õ–∏–Ω–∏—è –ª–∞–±–∏—Ä–∏–Ω—Ç–∞</button>
  <button class="btn line-purple" onclick="openMatch3()">üü£ –¢—Ä–∏ –≤ —Ä—è–¥</button>
</div>

<!-- ===== MEMORY CHARACTER SELECT ===== -->
<div id="memoryCharScreen" class="screen">
  <h2>üî¥ –õ–∏–Ω–∏—è –ø–∞–º—è—Ç–∏</h2>
  <p>–í—ã–±–µ—Ä–∏ –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π</p>
  <div class="char-grid">
    <div class="char-btn" onclick="selectMemorySet('smeshariki')">–°–º–µ—à–∞—Ä–∏–∫–∏</div>
    <div class="char-btn" onclick="selectMemorySet('fixiki')">–§–∏–∫—Å–∏–∫–∏</div>
    <div class="char-btn" onclick="selectMemorySet('masha')">–ú–∞—à–∞ –∏ –ú–µ–¥–≤–µ–¥—å</div>
    <div class="char-btn" onclick="selectMemorySet('vinni')">–í–∏–Ω–Ω–∏-–ü—É—Ö</div>
    <div class="char-btn" onclick="selectMemorySet('prost')">–ü—Ä–æ—Å—Ç–æ–∫–≤–∞—à–∏–Ω–æ</div>
  </div>
  <button class="btn gray" onclick="goMenu()">‚¨Ö –ù–∞–∑–∞–¥</button>
</div>

<!-- ===== MEMORY GAME ===== -->
<div id="memoryScreen" class="screen">
  <h2 id="memoryTitle">üî¥ –õ–∏–Ω–∏—è –ø–∞–º—è—Ç–∏</h2>
  <p>–í—ã–±–µ—Ä–∏ —Å–ª–æ–∂–Ω–æ—Å—Ç—å</p>
  <button class="btn gray" onclick="startMemory(8)">8 –∫–∞—Ä—Ç–æ—á–µ–∫</button>
  <button class="btn gray" onclick="startMemory(12)">12 –∫–∞—Ä—Ç–æ—á–µ–∫</button>
  <button class="btn gray" onclick="startMemory(16)">16 –∫–∞—Ä—Ç–æ—á–µ–∫</button>
  <button class="btn gray" onclick="startMemory(20)">20 –∫–∞—Ä—Ç–æ—á–µ–∫</button>

  <div id="memoryGrid" class="memory-grid"></div>

  <button class="btn gray" onclick="goMenu()">‚¨Ö –ù–∞–∑–∞–¥</button>
</div>

<!-- ===== MAZE CHARACTER SELECT ===== -->
<div id="mazeCharScreen" class="screen">
  <h2>üîµ –õ–∏–Ω–∏—è –ª–∞–±–∏—Ä–∏–Ω—Ç–∞</h2>
  <p>–í—ã–±–µ—Ä–∏ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞</p>
  <div class="char-grid">
    <div class="char-btn" onclick="selectMazeHero('cheb')">–ß–µ–±—É—Ä–∞—à–∫–∞ ‚Üí üçä</div>
    <div class="char-btn" onclick="selectMazeHero('pin')">–ü–∏–Ω ‚Üí ü§ñ</div>
    <div class="char-btn" onclick="selectMazeHero('matros')">–ú–∞—Ç—Ä–æ—Å–∫–∏–Ω ‚Üí üêÑ</div>
    <div class="char-btn" onclick="selectMazeHero('masha')">–ú–∞—à–∞ ‚Üí üè†</div>
  </div>
  <button class="btn gray" onclick="goMenu()">‚¨Ö –ù–∞–∑–∞–¥</button>
</div>

<!-- ===== MAZE GAME ===== -->
<div id="mazeScreen" class="screen">
  <h2 id="mazeTitle">üîµ –õ–∏–Ω–∏—è –ª–∞–±–∏—Ä–∏–Ω—Ç–∞</h2>
  <p id="mazeLevel">–£—Ä–æ–≤–µ–Ω—å 1</p>

  <div id="mazeGrid" class="maze"></div>

  <div class="controls">
    <button class="ctrl-btn" onclick="movePlayer(-1,0)">‚¨Ö</button>
    <button class="ctrl-btn" onclick="movePlayer(0,-1)">‚¨Ü</button>
    <button class="ctrl-btn" onclick="movePlayer(0,1)">‚¨á</button>
    <button class="ctrl-btn" onclick="movePlayer(1,0)">‚û°</button>
  </div>

  <button class="btn gray" onclick="goMenu()">‚¨Ö –ù–∞–∑–∞–¥</button>
</div>

<!-- ===== MATCH 3 ===== -->
<div id="match3Screen" class="screen">
  <h2>üü£ –¢—Ä–∏ –≤ —Ä—è–¥ ‚Äî –ú–µ—Ç—Ä–æ</h2>
  <p>–°–æ–µ–¥–∏–Ω—è–π 3 —Ü–≤–µ—Ç–∞ ‚Äî –ø–æ–ª—É—á–∞–π —Å—Ç–∞–Ω—Ü–∏–∏!</p>

  <div id="matchGrid" class="match-grid"></div>

  <div class="station-list">
    <b>–°–æ–±—Ä–∞–Ω–Ω—ã–µ —Å—Ç–∞–Ω—Ü–∏–∏:</b>
    <div id="stations"></div>
  </div>

  <button class="btn gray" onclick="goMenu()">‚¨Ö –ù–∞–∑–∞–¥</button>
</div>

<script>
/* ================= NAVIGATION ================= */

function showScreen(id){
  document.querySelectorAll(".screen").forEach(s=>s.classList.remove("active"));
  document.getElementById(id).classList.add("active");
}
function goMenu(){showScreen("menu");}
function openMemory(){showScreen("memoryCharScreen");}
function openMaze(){showScreen("mazeCharScreen");}
function openMatch3(){showScreen("match3Screen"); initMatch3();}

/* ================= MEMORY ================= */

let memorySet = [];

const memorySets = {
  smeshariki: ["üê∞","üê∑","üêª","ü¶î","ü¶â","üêß","üêÆ","üêµ","üê±","üê∂"],
  fixiki: ["üîß","‚öôÔ∏è","üîå","üîã","üí°","üì±","üß≤","üñ•Ô∏è","üì∫","üõ†Ô∏è"],
  masha: ["üëß","üêª","üçØ","üå≤","üè°","üçì","üéí","üêá","üå∏","üçé"],
  vinni: ["üêª","üçØ","üê∑","üêØ","üê∞","ü¶â","üê¥","üçØ","üå≥","üçé"],
  prost: ["üê±","üê∂","üêÆ","üë¶","üì¨","üè°","üåæ","üöú","üç∂","üêî"]
};

function selectMemorySet(set){
  memorySet = memorySets[set];
  const titles = {
    smeshariki:"–°–º–µ—à–∞—Ä–∏–∫–∏",
    fixiki:"–§–∏–∫—Å–∏–∫–∏",
    masha:"–ú–∞—à–∞ –∏ –ú–µ–¥–≤–µ–¥—å",
    vinni:"–í–∏–Ω–Ω–∏-–ü—É—Ö",
    prost:"–ü—Ä–æ—Å—Ç–æ–∫–≤–∞—à–∏–Ω–æ"
  };
  document.getElementById("memoryTitle").textContent =
    "üî¥ –õ–∏–Ω–∏—è –ø–∞–º—è—Ç–∏ ‚Äî " + titles[set];
  showScreen("memoryScreen");
  document.getElementById("memoryGrid").innerHTML="";
}

let firstCard=null, lockBoard=false;

function startMemory(total){
  const grid=document.getElementById("memoryGrid");
  grid.innerHTML="";
  firstCard=null; lockBoard=false;

  const pairs=total/2;
  const symbols=memorySet.slice(0,pairs);
  const cards=[...symbols,...symbols].sort(()=>Math.random()-0.5);

  grid.style.gridTemplateColumns=`repeat(${Math.ceil(Math.sqrt(total))},60px)`;

  cards.forEach(sym=>{
    const c=document.createElement("div");
    c.className="card";
    c.textContent="‚ùì";
    c.dataset.sym=sym;
    c.onclick=()=>flipCard(c);
    grid.appendChild(c);
  });
}

function flipCard(card){
  if(lockBoard||card.classList.contains("open"))return;
  card.classList.add("open");
  card.textContent=card.dataset.sym;

  if(!firstCard){firstCard=card;return;}
  if(firstCard.dataset.sym===card.dataset.sym){
    firstCard.classList.add("done");
    card.classList.add("done");
    firstCard=null;
  } else {
    lockBoard=true;
    setTimeout(()=>{
      firstCard.classList.remove("open");
      firstCard.textContent="‚ùì";
      card.classList.remove("open");
      card.textContent="‚ùì";
      firstCard=null;
      lockBoard=false;
    },800);
  }
}

/* ================= MAZE ================= */

const mazeSize=9;
let maze=[], player={x:1,y:1}, goal={x:mazeSize-2,y:mazeSize-2}, mazeLevel=1;
let mazeHero="üß∏", mazeGoalIcon="üçä";

function selectMazeHero(type){
  if(type==="cheb"){mazeHero="üß∏"; mazeGoalIcon="üçä";}
  if(type==="pin"){mazeHero="üêß"; mazeGoalIcon="ü§ñ";}
  if(type==="matros"){mazeHero="üê±"; mazeGoalIcon="üêÑ";}
  if(type==="masha"){mazeHero="üëß"; mazeGoalIcon="üè†";}
  mazeLevel=1;
  startMaze();
  showScreen("mazeScreen");
}

function startMaze(){
  generateMaze();
  document.getElementById("mazeTitle").textContent="üîµ –õ–∏–Ω–∏—è –ª–∞–±–∏—Ä–∏–Ω—Ç–∞ ‚Äî "+mazeHero;
  document.getElementById("mazeLevel").textContent="–£—Ä–æ–≤–µ–Ω—å "+mazeLevel;
  drawMaze();
}

function generateMaze(){
  maze=Array.from({length:mazeSize},()=>Array(mazeSize).fill(1));
  function carve(x,y){
    const dirs=[[1,0],[-1,0],[0,1],[0,-1]].sort(()=>Math.random()-0.5);
    for(const[dX,dY]of dirs){
      const nx=x+dX*2, ny=y+dY*2;
      if(nx>0&&ny>0&&nx<mazeSize-1&&ny<mazeSize-1&&maze[ny][nx]===1){
        maze[ny][nx]=0;
        maze[y+dY][x+dX]=0;
        carve(nx,ny);
      }
    }
  }
  maze[1][1]=0;
  carve(1,1);
  player={x:1,y:1};
  goal={x:mazeSize-2,y:mazeSize-2};
  maze[goal.y][goal.x]=0;
}

function drawMaze(){
  const grid=document.getElementById("mazeGrid");
  grid.innerHTML="";
  grid.style.gridTemplateColumns=`repeat(${mazeSize},40px)`;

  for(let y=0;y<mazeSize;y++){
    for(let x=0;x<mazeSize;x++){
      const d=document.createElement("div");
      d.className="cell";
      if(maze[y][x]===1)d.classList.add("wall");
      else d.classList.add("path");
      if(player.x===x&&player.y===y){
        d.classList.add("player");
        d.textContent=mazeHero;
      }
      if(goal.x===x&&goal.y===y){
        d.classList.add("goal");
        d.textContent=mazeGoalIcon;
      }
      grid.appendChild(d);
    }
  }
}

function movePlayer(dx,dy){
  const nx=player.x+dx, ny=player.y+dy;
  if(maze[ny][nx]!==0)return;
  player={x:nx,y:ny};
  drawMaze();
  if(nx===goal.x&&ny===goal.y){
    setTimeout(()=>{
      alert("üéâ –£—Ä–æ–≤–µ–Ω—å –ø—Ä–æ–π–¥–µ–Ω!");
      mazeLevel++;
      startMaze();
    },200);
  }
}

/* ================= MATCH 3 ================= */
/* (–ù–ï –¢–†–û–ì–ê–ï–ú ‚Äî –∫–∞–∫ —Ç—ã –ø—Ä–æ—Å–∏–ª) */

const matchColors=["üî¥","üîµ","üü¢","üü°","üü£"];
const matchSize=6;
let matchBoard=[], firstPick=null, stations=[];

function initMatch3(){
  const grid=document.getElementById("matchGrid");
  grid.innerHTML="";
  matchBoard=[];
  stations=[];
  document.getElementById("stations").innerHTML="";

  for(let i=0;i<matchSize*matchSize;i++){
    const c=matchColors[Math.floor(Math.random()*matchColors.length)];
    matchBoard.push(c);
  }
  drawMatch();
}

function drawMatch(){
  const grid=document.getElementById("matchGrid");
  grid.innerHTML="";
  grid.style.gridTemplateColumns=`repeat(${matchSize},50px)`;
  matchBoard.forEach((c,i)=>{
    const d=document.createElement("div");
    d.className="tile";
    d.textContent=c;
    d.onclick=()=>selectMatch(i);
    grid.appendChild(d);
  });
}

function selectMatch(i){
  if(firstPick===null){firstPick=i; return;}
  swapMatch(firstPick,i);
  firstPick=null;
  setTimeout(checkMatch,200);
}

function swapMatch(a,b){
  [matchBoard[a],matchBoard[b]]=[matchBoard[b],matchBoard[a]];
  drawMatch();
}

function checkMatch(){
  let found=false;
  for(let r=0;r<matchSize;r++){
    for(let c=0;c<matchSize-2;c++){
      const i=r*matchSize+c;
      const col=matchBoard[i];
      if(col&&matchBoard[i+1]===col&&matchBoard[i+2]===col){
        awardStation(col);
        matchBoard[i]=matchBoard[i+1]=matchBoard[i+2]=null;
        found=true;
      }
    }
  }
  for(let c=0;c<matchSize;c++){
    for(let r=0;r<matchSize-2;r++){
      const i=r*matchSize+c;
      const col=matchBoard[i];
      if(col&&matchBoard[i+matchSize]===col&&matchBoard[i+2*matchSize]===col){
        awardStation(col);
        matchBoard[i]=matchBoard[i+matchSize]=matchBoard[i+2*matchSize]=null;
        found=true;
      }
    }
  }
  if(found){
    dropMatch();
    setTimeout(checkMatch,200);
  }
}

function dropMatch(){
  for(let c=0;c<matchSize;c++){
    let col=[];
    for(let r=0;r<matchSize;r++){
      const i=r*matchSize+c;
      if(matchBoard[i]) col.push(matchBoard[i]);
    }
    while(col.length<matchSize){
      col.unshift(matchColors[Math.floor(Math.random()*matchColors.length)]);
    }
    for(let r=0;r<matchSize;r++){
      matchBoard[r*matchSize+c]=col[r];
    }
  }
  drawMatch();
}

function awardStation(col){
  if(!stations.includes(col)){
    stations.push(col);
    document.getElementById("stations").innerHTML=stations.join(" ");
  }
}
</script>

</body>
</html>