<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>–ò–≥—Ä—ã –≤ –º–µ—Ç—Ä–æ</title>
<style>
body {
  margin: 0;
  font-family: Arial, sans-serif;
  background: #b11217;
  color: white;
  text-align: center;
}

button {
  padding: 14px 22px;
  margin: 8px;
  font-size: 18px;
  border-radius: 30px;
  border: none;
  cursor: pointer;
}

.main-btn {
  background: white;
  color: black;
  font-weight: bold;
}

.small-btn {
  background: white;
  color: black;
  font-size: 16px;
}

.hidden { display: none; }

.grid {
  display: grid;
  gap: 10px;
  justify-content: center;
  margin-top: 20px;
}

.card {
  width: 70px;
  height: 70px;
  background: #333;
  border-radius: 12px;
  font-size: 34px;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
}

.card.open {
  background: white;
  color: black;
}

#maze {
  display: grid;
  gap: 4px;
  justify-content: center;
  margin-top: 20px;
}

.cell {
  width: 42px;
  height: 42px;
  background: #222;
  border-radius: 8px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 26px;
}

.path { background: #eee; color: black; }
.player { background: #4caf50; }
.goal { background: gold; }

.controls button {
  width: 70px;
  height: 50px;
  font-size: 22px;
  border-radius: 14px;
}
</style>
</head>
<body>

<!-- –ì–õ–ê–í–ù–´–ô –≠–ö–†–ê–ù -->
<div id="home">
  <h1 style="font-size:42px;">–ò–ì–†–´ –í –ú–ï–¢–†–û</h1>
  <h2>–í—ã–±–µ—Ä–∏ –ª–∏–Ω–∏—é</h2>

  <button class="main-btn" onclick="showMemoryLine()">üî¥ –õ–∏–Ω–∏—è –ø–∞–º—è—Ç–∏</button><br>
  <button class="main-btn" onclick="showMazeLine()">üîµ –õ–∏–Ω–∏—è –ª–∞–±–∏—Ä–∏–Ω—Ç–∞</button>
</div>

<!-- –õ–ò–ù–ò–Ø –ü–ê–ú–Ø–¢–ò -->
<div id="memoryLine" class="hidden">
  <h1>üî¥ –õ–∏–Ω–∏—è –ø–∞–º—è—Ç–∏</h1>
  <h3>–í—ã–±–µ—Ä–∏ –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π</h3>

  <button class="small-btn" onclick="showMemoryLevels('smeshariki')">–°–º–µ—à–∞—Ä–∏–∫–∏</button>
  <button class="small-btn" onclick="showMemoryLevels('fixiki')">–§–∏–∫—Å–∏–∫–∏</button>
  <button class="small-btn" onclick="showMemoryLevels('masha')">–ú–∞—à–∞ –∏ –ú–µ–¥–≤–µ–¥—å</button>
  <button class="small-btn" onclick="showMemoryLevels('winnie')">–í–∏–Ω–Ω–∏ –ü—É—Ö</button>
  <button class="small-btn" onclick="showMemoryLevels('prostokvashino')">–ü—Ä–æ—Å—Ç–æ–∫–≤–∞—à–∏–Ω–æ</button>

  <br><br>
  <button class="small-btn" onclick="goHome()">‚¨Ö –ù–∞–∑–∞–¥</button>
</div>

<!-- –í–´–ë–û–† –°–õ–û–ñ–ù–û–°–¢–ò –ü–ê–ú–Ø–¢–ò -->
<div id="memoryLevels" class="hidden">
  <h1>–í—ã–±–µ—Ä–∏ —Å–ª–æ–∂–Ω–æ—Å—Ç—å</h1>
  <button class="small-btn" onclick="startMemoryGame(4)">8 –∫–∞—Ä—Ç–æ—á–µ–∫</button>
  <button class="small-btn" onclick="startMemoryGame(6)">12 –∫–∞—Ä—Ç–æ—á–µ–∫</button>
  <button class="small-btn" onclick="startMemoryGame(8)">16 –∫–∞—Ä—Ç–æ—á–µ–∫</button>
  <button class="small-btn" onclick="startMemoryGame(10)">20 –∫–∞—Ä—Ç–æ—á–µ–∫</button>
  <br><br>
  <button class="small-btn" onclick="showMemoryLine()">‚¨Ö –ù–∞–∑–∞–¥</button>
</div>

<!-- –ò–ì–†–ê –ü–ê–ú–Ø–¢–ò -->
<div id="memoryGame" class="hidden">
  <h1>–ù–∞–π–¥–∏ –ø–∞—Ä—É</h1>
  <h3 id="memoryTitle"></h3>
  <div class="grid" id="memoryGrid"></div>
  <p id="memoryStatus"></p>
  <button id="nextMemoryLevelBtn" class="small-btn hidden" onclick="nextMemoryLevel()">‚û° –°–ª–µ–¥—É—é—â–∏–π —É—Ä–æ–≤–µ–Ω—å</button>
  <br><br>
  <button class="small-btn" onclick="showMemoryLine()">‚¨Ö –ù–∞–∑–∞–¥</button>
</div>

<!-- –õ–ò–ù–ò–Ø –õ–ê–ë–ò–†–ò–ù–¢–ê -->
<div id="mazeLine" class="hidden">
  <h1>üîµ –õ–∏–Ω–∏—è –ª–∞–±–∏—Ä–∏–Ω—Ç–∞</h1>
  <h3>–í—ã–±–µ—Ä–∏ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞</h3>

  <button class="small-btn" onclick="startMazeGame('cheburashka')">–ß–µ–±—É—Ä–∞—à–∫–∞ üçä</button>
  <button class="small-btn" onclick="startMazeGame('pin')">–ü–∏–Ω ü§ñ</button>
  <button class="small-btn" onclick="startMazeGame('matroskin')">–ú–∞—Ç—Ä–æ—Å–∫–∏–Ω üêÑ</button>
  <button class="small-btn" onclick="startMazeGame('masha')">–ú–∞—à–∞ üè†</button>

  <br><br>
  <button class="small-btn" onclick="goHome()">‚¨Ö –ù–∞–∑–∞–¥</button>
</div>

<!-- –ò–ì–†–ê –õ–ê–ë–ò–†–ò–ù–¢ -->
<div id="mazeGame" class="hidden">
  <h1 id="mazeTitle"></h1>
  <h3 id="mazeLevelText"></h3>
  <div id="maze"></div>

  <div class="controls">
    <br>
    <button onclick="move(0,-1)">‚¨Ü</button><br>
    <button onclick="move(-1,0)">‚¨Ö</button>
    <button onclick="move(1,0)">‚û°</button><br>
    <button onclick="move(0,1)">‚¨á</button>
  </div>

  <br>
  <button id="nextMazeBtn" class="small-btn hidden" onclick="nextMazeLevel()">‚û° –°–ª–µ–¥—É—é—â–∏–π —É—Ä–æ–≤–µ–Ω—å</button>
  <br>
  <button class="small-btn" onclick="showMazeLine()">‚¨Ö –ù–∞–∑–∞–¥</button>
</div>

<script>
/* ---------- –ù–ê–í–ò–ì–ê–¶–ò–Ø ---------- */
function hideAll() {
  home.style.display = "none";
  memoryLine.style.display = "none";
  memoryLevels.style.display = "none";
  memoryGame.style.display = "none";
  mazeLine.style.display = "none";
  mazeGame.style.display = "none";
}

function goHome() {
  hideAll();
  home.style.display = "block";
}

function showMemoryLine() {
  hideAll();
  memoryLine.style.display = "block";
}

function showMazeLine() {
  hideAll();
  mazeLine.style.display = "block";
}

/* ---------- –ù–ê–ô–î–ò –ü–ê–†–£ ---------- */

const memorySets = {
  smeshariki: ["üê∞","üêª","üêß","üê∑","üê∏","üêÆ","üêî","ü¶â","üêº","üêØ"],
  fixiki: ["üîß","‚öôÔ∏è","üîå","üí°","ü™õ","üîã","üì°","üíª","üñ•Ô∏è","üì±"],
  masha: ["üëß","üêª","üå≤","üçØ","üè†","üå∏","üåº","üêù","üß∏","üåª"],
  winnie: ["üêª","üçØ","üê∑","üêØ","ü¶â","üê∞","üå≥","üçé","üçØ","üç™"],
  prostokvashino: ["üê±","üê∂","üêÑ","üìÆ","ü•õ","üöú","üè†","üåæ","üßÄ","üêî"]
};

let memoryCharacterSet = [];
let memoryPairsCount = 4;
let opened = [];
let matched = 0;
let currentMemoryLevel = 0;
const memoryLevelsList = [4, 6, 8, 10]; // –ø–∞—Ä—ã

function showMemoryLevels(type) {
  memoryCharacterSet = memorySets[type];
  currentMemoryLevel = 0;
  hideAll();
  memoryLevels.style.display = "block";
}

function startMemoryGame(pairs) {
  memoryPairsCount = pairs;
  hideAll();
  memoryGame.style.display = "block";
  setupMemoryLevel();
}

function setupMemoryLevel() {
  memoryTitle.textContent = `–£—Ä–æ–≤–µ–Ω—å ${memoryLevelsList.indexOf(memoryPairsCount)+1} ‚Äî ${memoryPairsCount*2} –∫–∞—Ä—Ç–æ—á–µ–∫`;
  memoryStatus.textContent = "";
  nextMemoryLevelBtn.classList.add("hidden");

  const selected = memoryCharacterSet.slice(0, memoryPairsCount);
  const cards = [...selected, ...selected].sort(() => Math.random() - 0.5);

  memoryGrid.innerHTML = "";
  matched = 0;
  opened = [];

  const cols = memoryPairsCount <= 4 ? 4 : memoryPairsCount <= 6 ? 4 : memoryPairsCount <= 8 ? 4 : 5;
  memoryGrid.style.gridTemplateColumns = `repeat(${cols}, 70px)`;

  cards.forEach(icon => {
    const card = document.createElement("div");
    card.className = "card";
    card.dataset.icon = icon;
    card.textContent = "";
    card.onclick = () => flip(card);
    memoryGrid.appendChild(card);
  });
}

function flip(card) {
  if (opened.length === 2 || card.classList.contains("open")) return;

  card.classList.add("open");
  card.textContent = card.dataset.icon;
  opened.push(card);

  if (opened.length === 2) {
    if (opened[0].dataset.icon === opened[1].dataset.icon) {
      matched += 2;
      opened = [];
      if (matched === memoryPairsCount * 2) {
        memoryStatus.textContent = "üéâ –£—Ä–æ–≤–µ–Ω—å –ø—Ä–æ–π–¥–µ–Ω!";
        nextMemoryLevelBtn.classList.remove("hidden");
      }
    } else {
      setTimeout(() => {
        opened.forEach(c => {
          c.classList.remove("open");
          c.textContent = "";
        });
        opened = [];
      }, 700);
    }
  }
}

function nextMemoryLevel() {
  const idx = memoryLevelsList.indexOf(memoryPairsCount);
  if (idx < memoryLevelsList.length - 1) {
    memoryPairsCount = memoryLevelsList[idx + 1];
    setupMemoryLevel();
  } else {
    memoryStatus.textContent = "üèÜ –¢—ã –ø—Ä–æ—à—ë–ª –≤—Å–µ —É—Ä–æ–≤–Ω–∏!";
    nextMemoryLevelBtn.classList.add("hidden");
  }
}

/* ---------- –õ–ê–ë–ò–†–ò–ù–¢ ---------- */

const mazeTemplates = [
  [
    "#######",
    "#.....#",
    "#.###.#",
    "#.#...#",
    "#.#.###",
    "#.....#",
    "#######"
  ],
  [
    "#######",
    "#...#.#",
    "#.#.#.#",
    "#.#...#",
    "#.###.#",
    "#.....#",
    "#######"
  ],
  [
    "#######",
    "#.....#",
    "###.###",
    "#.....#",
    "#.#####",
    "#.....#",
    "#######"
  ],
  [
    "#######",
    "#..#..#",
    "#.##.#.#",
    "#....#.#",
    "###.##.#",
    "#......#",
    "#######"
  ]
];

const mazeCharacters = {
  cheburashka: { icon: "üêª", goal: "üçä", text: "–ß–µ–±—É—Ä–∞—à–∫–∞ –∏–¥—ë—Ç –∫ üçä" },
  pin: { icon: "üêß", goal: "ü§ñ", text: "–ü–∏–Ω –∏–¥—ë—Ç –∫ –ë–∏–±–∏ ü§ñ" },
  matroskin: { icon: "üê±", goal: "üêÑ", text: "–ú–∞—Ç—Ä–æ—Å–∫–∏–Ω –∏–¥—ë—Ç –∫ –ú—É—Ä–∫–µ üêÑ" },
  masha: { icon: "üëß", goal: "üè†", text: "–ú–∞—à–∞ –∏–¥—ë—Ç –∫ –¥–æ–º—É –ú–∏—à–∫–∏ üè†" }
};

let mazeData, playerPos, goalPos, playerIcon;
let mazeLevel = 0;
let mazeOrder = [];

function startMazeGame(type) {
  currentMazeChar = mazeCharacters[type];
  mazeLevel = 0;
  mazeOrder = shuffle([...mazeTemplates]);
  hideAll();
  mazeGame.style.display = "block";
  loadMazeLevel();
}

function loadMazeLevel() {
  const template = mazeOrder[mazeLevel];
  mazeData = template.map(r => r.split(""));
  playerPos = { x: 1, y: 1 };
  goalPos = { x: mazeData[0].length - 2, y: mazeData.length - 2 };
  playerIcon = currentMazeChar.icon;

  mazeTitle.textContent = currentMazeChar.text;
  mazeLevelText.textContent = `–£—Ä–æ–≤–µ–Ω—å ${mazeLevel + 1}`;
  nextMazeBtn.classList.add("hidden");
  drawMaze();
}

function drawMaze() {
  maze.innerHTML = "";
  maze.style.gridTemplateColumns = `repeat(${mazeData[0].length}, 42px)`;

  mazeData.forEach((row, y) => {
    row.forEach((cell, x) => {
      const div = document.createElement("div");
      div.className = "cell";

      if (cell === "#") div.style.background = "#000";
      else div.classList.add("path");

      if (x === goalPos.x && y === goalPos.y) {
        div.textContent = currentMazeChar.goal;
        div.classList.add("goal");
      }

      if (x === playerPos.x && y === playerPos.y) {
        div.textContent = playerIcon;
        div.classList.add("player");
      }

      maze.appendChild(div);
    });
  });
}

function move(dx, dy) {
  if (nextMazeBtn.style.display === "inline-block") return;

  const nx = playerPos.x + dx;
  const ny = playerPos.y + dy;

  if (mazeData[ny][nx] === "#") return;

  playerPos = { x: nx, y: ny };
  drawMaze();

  if (nx === goalPos.x && ny === goalPos.y) {
    nextMazeBtn.classList.remove("hidden");
  }
}

function nextMazeLevel() {
  mazeLevel++;
  if (mazeLevel < mazeOrder.length) {
    loadMazeLevel();
  } else {
    mazeLevelText.textContent = "üèÜ –¢—ã –ø—Ä–æ—à—ë–ª –≤—Å–µ –ª–∞–±–∏—Ä–∏–Ω—Ç—ã!";
    nextMazeBtn.classList.add("hidden");
  }
}

/* ---------- –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–û–ï ---------- */
function shuffle(arr) {
  return arr.sort(() => Math.random() - 0.5);
}
</script>

</body>
</html>