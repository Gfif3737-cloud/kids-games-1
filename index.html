<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>–ò–≥—Ä—ã –≤ –º–µ—Ç—Ä–æ</title>
<style>
body{
  margin:0;
  background:#b0161a;
  color:white;
  font-family:Arial, sans-serif;
  text-align:center;
}
.screen{display:none;padding:20px;}
.active{display:block;}
h1{font-size:34px;margin:20px 0;}
h2{font-size:24px;}
.btn{
  background:white;
  color:#b0161a;
  border:none;
  border-radius:30px;
  padding:14px 26px;
  font-size:18px;
  margin:10px;
  cursor:pointer;
}
.grid{
  display:grid;
  grid-template-columns:repeat(4,70px);
  gap:12px;
  justify-content:center;
  margin:20px auto;
}
.card{
  width:70px;height:70px;
  background:#333;
  border-radius:12px;
  display:flex;
  justify-content:center;
  align-items:center;
  font-size:32px;
  cursor:pointer;
}
.card.open{background:white;color:black;}
.card.matched{background:#4caf50;color:white;}
#maze{
  display:grid;
  gap:6px;
  justify-content:center;
  margin:20px auto;
}
.cell{
  width:40px;height:40px;
  border-radius:8px;
  background:black;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:22px;
}
.path{background:white;}
.player{background:#4caf50;}
.goal{background:gold;}
.controls{
  display:flex;
  justify-content:center;
  gap:14px;
  margin-top:20px;
}
.controls button{
  width:60px;height:60px;
  border-radius:50%;
  font-size:24px;
  border:none;
}
</style>
</head>

<body>

<!-- ===== –ì–õ–ê–í–ù–´–ô –≠–ö–†–ê–ù ===== -->
<div id="home" class="screen active">
  <h1>–ò–ì–†–´ –í –ú–ï–¢–†–û</h1>
  <h2>–í—ã–±–µ—Ä–∏ –ª–∏–Ω–∏—é</h2>
  <button class="btn" onclick="openMemory()">üü¢ –õ–∏–Ω–∏—è –ø–∞–º—è—Ç–∏</button><br>
  <button class="btn" onclick="openMazeMenu()">üîµ –õ–∏–Ω–∏—è –ª–∞–±–∏—Ä–∏–Ω—Ç–∞</button>
</div>

<!-- ===== –ú–ï–ù–Æ –ü–ê–ú–Ø–¢–ò ===== -->
<div id="memoryMenu" class="screen">
  <h2>–õ–∏–Ω–∏—è –ø–∞–º—è—Ç–∏</h2>
  <button class="btn" onclick="startMemory('–°–º–µ—à–∞—Ä–∏–∫–∏')">–°–º–µ—à–∞—Ä–∏–∫–∏</button>
  <button class="btn" onclick="startMemory('–§–∏–∫—Å–∏–∫–∏')">–§–∏–∫—Å–∏–∫–∏</button>
  <button class="btn" onclick="startMemory('–ú–∞—à–∞ –∏ –ú–µ–¥–≤–µ–¥—å')">–ú–∞—à–∞ –∏ –ú–µ–¥–≤–µ–¥—å</button>
  <button class="btn" onclick="startMemory('–í–∏–Ω–Ω–∏ –ü—É—Ö')">–í–∏–Ω–Ω–∏ –ü—É—Ö</button>
  <button class="btn" onclick="startMemory('–ü—Ä–æ—Å—Ç–æ–∫–≤–∞—à–∏–Ω–æ')">–ü—Ä–æ—Å—Ç–æ–∫–≤–∞—à–∏–Ω–æ</button><br>
  <button class="btn" onclick="goHome()">‚¨Ö –ù–∞–∑–∞–¥</button>
</div>

<!-- ===== –ò–ì–†–ê –ü–ê–ú–Ø–¢–ò ===== -->
<div id="memoryGame" class="screen">
  <h2 id="memoryTitle"></h2>
  <div id="memoryGrid" class="grid"></div>
  <button class="btn" onclick="openMemory()">‚¨Ö –ù–∞–∑–∞–¥</button>
</div>

<!-- ===== –ú–ï–ù–Æ –õ–ê–ë–ò–†–ò–ù–¢–ê ===== -->
<div id="mazeMenu" class="screen">
  <h2>–õ–∏–Ω–∏—è –ª–∞–±–∏—Ä–∏–Ω—Ç–∞</h2>
  <button class="btn" onclick="startMaze('–ß–µ–±—É—Ä–∞—à–∫–∞','üçä')">–ß–µ–±—É—Ä–∞—à–∫–∞ ‚Üí üçä</button>
  <button class="btn" onclick="startMaze('–ü–∏–Ω','ü§ñ')">–ü–∏–Ω ‚Üí ü§ñ</button>
  <button class="btn" onclick="startMaze('–ú–∞—Ç—Ä–æ—Å–∫–∏–Ω','üêÑ')">–ú–∞—Ç—Ä–æ—Å–∫–∏–Ω ‚Üí üêÑ</button>
  <button class="btn" onclick="startMaze('–ú–∞—à–∞','üè†')">–ú–∞—à–∞ ‚Üí üè†</button><br>
  <button class="btn" onclick="goHome()">‚¨Ö –ù–∞–∑–∞–¥</button>
</div>

<!-- ===== –õ–ê–ë–ò–†–ò–ù–¢ ===== -->
<div id="mazeGame" class="screen">
  <h2 id="mazeTitle"></h2>
  <h3 id="mazeLevel"></h3>
  <div id="maze"></div>

  <div class="controls">
    <button onclick="movePlayer(0,-1)">‚¨ÜÔ∏è</button>
  </div>
  <div class="controls">
    <button onclick="movePlayer(-1,0)">‚¨ÖÔ∏è</button>
    <button onclick="movePlayer(1,0)">‚û°Ô∏è</button>
  </div>
  <div class="controls">
    <button onclick="movePlayer(0,1)">‚¨áÔ∏è</button>
  </div>

  <button class="btn" onclick="openMazeMenu()">‚¨Ö –ù–∞–∑–∞–¥</button>
</div>

<script>
/* ===== –ù–ê–í–ò–ì–ê–¶–ò–Ø ===== */
function show(id){
  document.querySelectorAll('.screen').forEach(s=>s.classList.remove('active'));
  document.getElementById(id).classList.add('active');
}
function goHome(){show('home');}
function openMemory(){show('memoryMenu');}
function openMazeMenu(){show('mazeMenu');}

/* ======================================================
   ================ –õ–ò–ù–ò–Ø –ü–ê–ú–Ø–¢–ò (–ù–ï –ú–ï–ù–Ø–õ!) ============
   ====================================================== */
let memoryFirst=null, memoryLock=false;

function startMemory(name){
  show('memoryGame');
  document.getElementById('memoryTitle').innerText='–ü–µ—Ä—Å–æ–Ω–∞–∂–∏: '+name;

  const grid=document.getElementById('memoryGrid');
  grid.innerHTML='';

  const emojis=["üê∞","üêª","üê∏","üê∑","ü¶ä","üêº","üê®","üêØ","üêÆ","üêµ"];
  const cards=[...emojis.slice(0,8),...emojis.slice(0,8)].sort(()=>Math.random()-0.5);

  cards.forEach(e=>{
    const d=document.createElement('div');
    d.className='card';
    d.innerText='';
    d.onclick=()=>flipCard(d,e);
    grid.appendChild(d);
  });
}

function flipCard(card,emoji){
  if(memoryLock||card.classList.contains('open'))return;
  card.classList.add('open');
  card.innerText=emoji;

  if(!memoryFirst){memoryFirst=card;return;}

  if(memoryFirst.innerText===emoji){
    card.classList.add('matched');
    memoryFirst.classList.add('matched');
    memoryFirst=null;
  }else{
    memoryLock=true;
    setTimeout(()=>{
      card.classList.remove('open');
      memoryFirst.classList.remove('open');
      card.innerText='';
      memoryFirst.innerText='';
      memoryFirst=null;
      memoryLock=false;
    },700);
  }
}

/* ======================================================
   ================ –õ–ê–ë–ò–†–ò–ù–¢ (–ù–û–í–´–ô –ì–ï–ù–ï–†–ê–¢–û–†) ==========
   ====================================================== */

let maze=[], size=9;
let px=0, py=0, gx=0, gy=0;
let mazeLevel=1;
let playerEmoji='', goalEmoji='';

function startMaze(name, goal){
  show('mazeGame');
  mazeLevel=1;
  playerEmoji=getEmoji(name);
  goalEmoji=goal;
  document.getElementById('mazeTitle').innerText=name+" –∏–¥—ë—Ç –∫ "+goalEmoji;
  generateMaze();
}

function getEmoji(name){
  if(name==="–ß–µ–±—É—Ä–∞—à–∫–∞") return "üêª";
  if(name==="–ü–∏–Ω") return "üêß";
  if(name==="–ú–∞—Ç—Ä–æ—Å–∫–∏–Ω") return "üê±";
  if(name==="–ú–∞—à–∞") return "üëß";
  return "üôÇ";
}

/* ===== –ì–ï–ù–ï–†–ê–¢–û–† –° –ì–ê–†–ê–ù–¢–ò–†–û–í–ê–ù–ù–´–ú –ü–£–¢–Å–ú ===== */
function generateMaze(){
  size = 7 + mazeLevel; // —Ä–∞—Å—Ç—ë—Ç —Å —É—Ä–æ–≤–Ω–µ–º
  if(size>11) size=11;

  maze = Array.from({length:size},()=>Array(size).fill(1));

  function carve(x,y){
    maze[y][x]=0;
    const dirs=[[1,0],[-1,0],[0,1],[0,-1]].sort(()=>Math.random()-0.5);
    for(const[dX,dY]of dirs){
      const nx=x+dX*2, ny=y+dY*2;
      if(nx>0&&ny>0&&nx<size-1&&ny<size-1&&maze[ny][nx]===1){
        maze[y+dY][x+dX]=0;
        carve(nx,ny);
      }
    }
  }

  carve(1,1);

  px=1; py=1;
  gx=size-2; gy=size-2;
  maze[py][px]=0;
  maze[gy][gx]=0;

  drawMaze();
}

function drawMaze(){
  const m=document.getElementById('maze');
  m.style.gridTemplateColumns=`repeat(${size},40px)`;
  m.innerHTML='';

  for(let y=0;y<size;y++){
    for(let x=0;x<size;x++){
      const c=document.createElement('div');
      c.className='cell';
      if(maze[y][x]===0) c.classList.add('path');
      if(x===px&&y===py){
        c.classList.add('player');
        c.innerText=playerEmoji;
      }
      if(x===gx&&y===gy){
        c.classList.add('goal');
        c.innerText=goalEmoji;
      }
      m.appendChild(c);
    }
  }

  document.getElementById('mazeLevel').innerText="–£—Ä–æ–≤–µ–Ω—å "+mazeLevel;
}

function movePlayer(dx,dy){
  const nx=px+dx, ny=py+dy;
  if(nx<0||ny<0||nx>=size||ny>=size) return;
  if(maze[ny][nx]===1) return;

  px=nx; py=ny;
  drawMaze();

  if(px===gx&&py===gy){
    setTimeout(()=>{
      mazeLevel++;
      generateMaze();
    },300);
  }
}
</script>

</body>
</html>