<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>–ò–≥—Ä—ã –≤ –º–µ—Ç—Ä–æ</title>
<style>
body {
  margin: 0;
  font-family: Arial, sans-serif;
  background: #b11217;
  color: white;
  text-align: center;
}

button {
  padding: 14px 22px;
  margin: 10px;
  font-size: 18px;
  border-radius: 30px;
  border: none;
  cursor: pointer;
}

.main-btn {
  background: white;
  color: black;
  font-weight: bold;
}

.small-btn {
  background: white;
  color: black;
  font-size: 16px;
}

.hidden { display: none; }

.grid {
  display: grid;
  grid-template-columns: repeat(4, 70px);
  gap: 10px;
  justify-content: center;
  margin-top: 20px;
}

.card {
  width: 70px;
  height: 70px;
  background: #333;
  border-radius: 12px;
  font-size: 36px;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
}

.card.open {
  background: white;
  color: black;
}

#maze {
  display: grid;
  grid-template-columns: repeat(7, 45px);
  gap: 4px;
  justify-content: center;
  margin-top: 20px;
}

.cell {
  width: 45px;
  height: 45px;
  background: #222;
  border-radius: 8px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 26px;
}

.path { background: #eee; color: black; }
.player { background: #4caf50; }
.goal { background: gold; }

.controls button {
  width: 70px;
  height: 50px;
  font-size: 22px;
  border-radius: 14px;
}
</style>
</head>
<body>

<!-- –ì–õ–ê–í–ù–´–ô –≠–ö–†–ê–ù -->
<div id="home">
  <h1 style="font-size:42px;">–ò–ì–†–´ –í –ú–ï–¢–†–û</h1>
  <h2>–í—ã–±–µ—Ä–∏ –ª–∏–Ω–∏—é</h2>

  <button class="main-btn" onclick="showMemoryLine()">üî¥ –õ–∏–Ω–∏—è –ø–∞–º—è—Ç–∏</button><br>
  <button class="main-btn" onclick="showMazeLine()">üîµ –õ–∏–Ω–∏—è –ª–∞–±–∏—Ä–∏–Ω—Ç–∞</button>
</div>

<!-- –õ–ò–ù–ò–Ø –ü–ê–ú–Ø–¢–ò -->
<div id="memoryLine" class="hidden">
  <h1>üî¥ –õ–∏–Ω–∏—è –ø–∞–º—è—Ç–∏</h1>
  <h3>–í—ã–±–µ—Ä–∏ –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π</h3>

  <button class="small-btn" onclick="startMemory('smeshariki')">–°–º–µ—à–∞—Ä–∏–∫–∏</button>
  <button class="small-btn" onclick="startMemory('fixiki')">–§–∏–∫—Å–∏–∫–∏</button>
  <button class="small-btn" onclick="startMemory('masha')">–ú–∞—à–∞ –∏ –ú–µ–¥–≤–µ–¥—å</button>
  <button class="small-btn" onclick="startMemory('winnie')">–í–∏–Ω–Ω–∏ –ü—É—Ö</button>
  <button class="small-btn" onclick="startMemory('prostokvashino')">–ü—Ä–æ—Å—Ç–æ–∫–≤–∞—à–∏–Ω–æ</button>

  <br><br>
  <button class="small-btn" onclick="goHome()">‚¨Ö –ù–∞–∑–∞–¥</button>
</div>

<!-- –ò–ì–†–ê –ù–ê–ô–î–ò –ü–ê–†–£ -->
<div id="memoryGame" class="hidden">
  <h1>–ù–∞–π–¥–∏ –ø–∞—Ä—É</h1>
  <h3 id="memoryTitle"></h3>
  <div class="grid" id="memoryGrid"></div>
  <br>
  <button class="small-btn" onclick="showMemoryLine()">‚¨Ö –ù–∞–∑–∞–¥</button>
</div>

<!-- –õ–ò–ù–ò–Ø –õ–ê–ë–ò–†–ò–ù–¢–ê -->
<div id="mazeLine" class="hidden">
  <h1>üîµ –õ–∏–Ω–∏—è –ª–∞–±–∏—Ä–∏–Ω—Ç–∞</h1>
  <h3>–í—ã–±–µ—Ä–∏ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞</h3>

  <button class="small-btn" onclick="startMaze('cheburashka')">–ß–µ–±—É—Ä–∞—à–∫–∞ üçä</button>
  <button class="small-btn" onclick="startMaze('pin')">–ü–∏–Ω ü§ñ</button>
  <button class="small-btn" onclick="startMaze('matroskin')">–ú–∞—Ç—Ä–æ—Å–∫–∏–Ω üêÑ</button>
  <button class="small-btn" onclick="startMaze('masha')">–ú–∞—à–∞ üè†</button>

  <br><br>
  <button class="small-btn" onclick="goHome()">‚¨Ö –ù–∞–∑–∞–¥</button>
</div>

<!-- –ò–ì–†–ê –õ–ê–ë–ò–†–ò–ù–¢ -->
<div id="mazeGame" class="hidden">
  <h1 id="mazeTitle"></h1>
  <div id="maze"></div>

  <div class="controls">
    <br>
    <button onclick="move(0,-1)">‚¨Ü</button><br>
    <button onclick="move(-1,0)">‚¨Ö</button>
    <button onclick="move(1,0)">‚û°</button><br>
    <button onclick="move(0,1)">‚¨á</button>
  </div>

  <br>
  <button class="small-btn" onclick="showMazeLine()">‚¨Ö –ù–∞–∑–∞–¥</button>
</div>

<script>
function hideAll() {
  home.style.display = "none";
  memoryLine.style.display = "none";
  memoryGame.style.display = "none";
  mazeLine.style.display = "none";
  mazeGame.style.display = "none";
}

function goHome() {
  hideAll();
  home.style.display = "block";
}

function showMemoryLine() {
  hideAll();
  memoryLine.style.display = "block";
}

function showMazeLine() {
  hideAll();
  mazeLine.style.display = "block";
}

/* ---------- –ù–ê–ô–î–ò –ü–ê–†–£ ---------- */

const memorySets = {
  smeshariki: ["üê∞","üêª","üêß","üê∑","üê∞","üêª","üêß","üê∑"],
  fixiki: ["üîß","‚öôÔ∏è","üîå","üí°","üîß","‚öôÔ∏è","üîå","üí°"],
  masha: ["üëß","üêª","üå≤","üçØ","üëß","üêª","üå≤","üçØ"],
  winnie: ["üêª","üçØ","üê∑","üêØ","üêª","üçØ","üê∑","üêØ"],
  prostokvashino: ["üê±","üê∂","üêÑ","üìÆ","üê±","üê∂","üêÑ","üìÆ"]
};

let firstCard = null;
let lock = false;

function startMemory(type) {
  hideAll();
  memoryGame.style.display = "block";
  memoryTitle.textContent = "–ü–µ—Ä—Å–æ–Ω–∞–∂–∏: " + type;

  const cards = [...memorySets[type]].sort(() => Math.random() - 0.5);
  memoryGrid.innerHTML = "";
  firstCard = null;
  lock = false;

  cards.forEach(icon => {
    const card = document.createElement("div");
    card.className = "card";
    card.textContent = "";
    card.dataset.icon = icon;
    card.onclick = () => flip(card);
    memoryGrid.appendChild(card);
  });
}

function flip(card) {
  if (lock || card.classList.contains("open")) return;

  card.classList.add("open");
  card.textContent = card.dataset.icon;

  if (!firstCard) {
    firstCard = card;
  } else {
    if (firstCard.dataset.icon === card.dataset.icon) {
      firstCard = null;
    } else {
      lock = true;
      setTimeout(() => {
        card.classList.remove("open");
        card.textContent = "";
        firstCard.classList.remove("open");
        firstCard.textContent = "";
        firstCard = null;
        lock = false;
      }, 700);
    }
  }
}

/* ---------- –õ–ê–ë–ò–†–ò–ù–¢ ---------- */

let mazeData, playerPos, goalPos, playerIcon;

const mazeTemplates = [
  [
    "#######",
    "#.....#",
    "#.###.#",
    "#.#...#",
    "#.#.###",
    "#.....#",
    "#######"
  ],
  [
    "#######",
    "#.....#",
    "#.###.#",
    "#...#.#",
    "###.#.#",
    "#.....#",
    "#######"
  ]
];

const mazeCharacters = {
  cheburashka: { icon: "üêª", goal: "üçä", text: "–ß–µ–±—É—Ä–∞—à–∫–∞ –∏–¥—ë—Ç –∫ üçä" },
  pin: { icon: "üêß", goal: "ü§ñ", text: "–ü–∏–Ω –∏–¥—ë—Ç –∫ –ë–∏–±–∏ ü§ñ" },
  matroskin: { icon: "üê±", goal: "üêÑ", text: "–ú–∞—Ç—Ä–æ—Å–∫–∏–Ω –∏–¥—ë—Ç –∫ –ú—É—Ä–∫–µ üêÑ" },
  masha: { icon: "üëß", goal: "üè†", text: "–ú–∞—à–∞ –∏–¥—ë—Ç –∫ –¥–æ–º—É –ú–∏—à–∫–∏ üè†" }
};

function startMaze(type) {
  hideAll();
  mazeGame.style.display = "block";

  const char = mazeCharacters[type];
  mazeTitle.textContent = char.text;
  playerIcon = char.icon;

  const template = mazeTemplates[Math.floor(Math.random() * mazeTemplates.length)];
  mazeData = template.map(row => row.split(""));

  playerPos = { x: 1, y: 1 };
  goalPos = { x: 5, y: 5 };

  drawMaze();
}

function drawMaze() {
  maze.innerHTML = "";
  mazeData.forEach((row, y) => {
    row.forEach((cell, x) => {
      const div = document.createElement("div");
      div.className = "cell";

      if (cell === "#") div.style.background = "#000";
      else div.classList.add("path");

      if (x === playerPos.x && y === playerPos.y) {
        div.textContent = playerIcon;
        div.classList.add("player");
      }

      if (x === goalPos.x && y === goalPos.y) {
        div.textContent = mazeCharactersGoal();
        div.classList.add("goal");
      }

      maze.appendChild(div);
    });
  });
}

function mazeCharactersGoal() {
  return mazeTitle.textContent.includes("üçä") ? "üçä" :
         mazeTitle.textContent.includes("ü§ñ") ? "ü§ñ" :
         mazeTitle.textContent.includes("üêÑ") ? "üêÑ" :
         "üè†";
}

function move(dx, dy) {
  const nx = playerPos.x + dx;
  const ny = playerPos.y + dy;

  if (mazeData[ny][nx] === "#") return;

  playerPos.x = nx;
  playerPos.y = ny;
  drawMaze();

  if (nx === goalPos.x && ny === goalPos.y) {
    setTimeout(() => alert("üéâ –¢—ã –¥–æ—à—ë–ª!"), 100);
  }
}
</script>

</body>
</html>